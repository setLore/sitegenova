<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>M&D — Shop</title>
	<link rel="stylesheet" href="css/shop.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>
<body>
	<!-- header replaced with index.html header -->
	<header class="site-header">
		<a href="index.html" class="logo-link" aria-label="M&D home">
			<img src="logo.png" alt="M&D logo" class="logo">
		</a>
		<nav id="site-nav" class="nav-buttons" role="navigation">
			<a class="nav-link" href="index.html">Home</a>
			<a class="nav-link" href="shop.html">Shop</a>
			<a class="nav-link" href="about.html">About</a>
		</nav>

		<div class="header-actions">
			<button class="menu-toggle" aria-controls="site-nav" aria-expanded="false" aria-label="Open menu">
				<span class="bar"></span>
				<span class="bar"></span>
				<span class="bar"></span>
			</button>

			<a class="cart-button" href="cart.html" aria-label="Open cart">
				<i class="bi bi-cart cart-icon" aria-hidden="true"></i>
				<span class="cart-count" aria-hidden="true">0</span>
			</a>
		</div>
	</header>

	<!-- ...existing product grid content ... -->
	<main class="page-main" role="main">
		<h1>Shop</h1>
		<div class="products" id="product-grid">
			<!-- 9 product cards -->
			<!-- For brevity images are placeholders; replace src with real images if available -->
			<div class="product" data-id="p1" data-name="Turbo" data-price="1099">
				<img src="turbo.png" alt="Turbo">
				<h3>Turbo</h3>
				<p>$1099</p>
				<button class="add-btn" type="button">Add to cart</button>
			</div>
			<div class="product" data-id="p2" data-name="Intercooler" data-price="499">
				<img src="intercooler.png" alt="Intercooler">
				<h3>Intercooler</h3>
				<p>$499</p>
				<button class="add-btn" type="button">Add to cart</button>
			</div>
			<div class="product" data-id="p3" data-name="Intake" data-price="299">
				<img src="intake.png" alt="Intake">
				<h3>Cold Air Intake</h3>
				<p>$299</p>
				<button class="add-btn" type="button">Add to cart</button>
			</div>
			<div class="product" data-id="p4" data-name="Exhaust" data-price="999">
				<img src="exhaust.png" alt="exhaust">
				<h3>Exhaust System</h3>
				<p>$999</p>
				<button class="add-btn" type="button">Add to cart</button>
			</div>
			<div class="product" data-id="p5" data-name="Kess" data-price="79.00">
				<img src="kess.png" alt="KESS V2 ECU Programmer">
				<h3>KESS V2 ECU Programmer</h3>
				<p>$2999</p>
				<button class="add-btn" type="button">Add to cart</button>
			</div>
			<div class="product" data-id="p6" data-name="Coilovers" data-price="899">
				<img src="coilover.png" alt="Coilovers">
				<h3>Coilovers</h3>
				<p>$899</p>
				<button class="add-btn" type="button">Add to cart</button>
			</div>

		</div>
	</main>

	<!-- footer replaced with index.html footer -->
	<footer class="site-footer">
		<div class="site-footer-inner">
			<span class="footer-left">© M&amp;D 2025</span>
			<div class="social-buttons" role="group" aria-label="Social links">
				<a class="social-button social-instagram" href="https://www.instagram.com/825a14" target="_blank" rel="noopener noreferrer" aria-label="Open Instagram">
					<i class="bi bi-instagram" aria-hidden="true"></i>
				</a>
				<a class="social-button social-tiktok" href="https://www.tiktok.com/@00_dimov" target="_blank" rel="noopener noreferrer" aria-label="Open TikTok">
					<i class="bi bi-tiktok" aria-hidden="true"></i>
				</a>
				<a class="social-button social-facebook" href="https://www.facebook.com/" target="_blank" rel="noopener noreferrer" aria-label="Open Facebook">
					<i class="bi bi-facebook" aria-hidden="true"></i>
				</a>
			</div>
		</div>
	</footer>

	<!-- unified site script (shop.html) — unchanged -->
	<script>
		(function(){
			const PAGE_SITE_TOKEN = 'site-v2';

			// If token changed, clear cart and notify other tabs
			(function ensureSiteToken(){
				const stored = localStorage.getItem('md_site_start_token');
				if (stored !== PAGE_SITE_TOKEN) {
					localStorage.removeItem('md_cart');
					localStorage.setItem('md_site_start_token', PAGE_SITE_TOKEN);
					localStorage.setItem('md_cart_sync', Date.now().toString());
				}
			})();

			/* Shared cart helpers */
			function getCart() {
				try { return JSON.parse(localStorage.getItem('md_cart') || '[]'); } catch (e) { return []; }
			}
			function saveCart(cart) {
				localStorage.setItem('md_cart', JSON.stringify(cart));
				localStorage.setItem('md_cart_sync', Date.now().toString());
			}
			function updateCartCount() {
				const cart = getCart();
				const totalQty = cart.reduce((s, i) => s + (i.qty || 1), 0);
				document.querySelectorAll('.cart-count').forEach(el => el.textContent = totalQty);
			}

			/* Menu toggle (shared) */
			(function bindMenuToggle(){
				const toggle = document.querySelector('.menu-toggle');
				const nav = document.getElementById('site-nav');
				if (!toggle || !nav) return;
				toggle.addEventListener('click', (e) => {
					e.stopPropagation();
					const isOpen = toggle.getAttribute('aria-expanded') === 'true';
					toggle.setAttribute('aria-expanded', String(!isOpen));
					toggle.setAttribute('aria-label', !isOpen ? 'Close menu' : 'Open menu');
					nav.classList.toggle('open', !isOpen);
				});
				nav.addEventListener('click', (e) => e.stopPropagation());
				window.addEventListener('resize', () => {
					if (window.innerWidth > 600) {
						toggle.setAttribute('aria-expanded','false');
						nav.classList.remove('open');
					}
				});
				document.addEventListener('click', (e) => {
					if (window.innerWidth <= 600 && nav.classList.contains('open')) {
						if (!nav.contains(e.target) && !toggle.contains(e.target)) {
							toggle.setAttribute('aria-expanded','false');
							nav.classList.remove('open');
						}
					}
				});
			})();

			/* Shop: Add to cart (if product grid exists) */
			const productGrid = document.getElementById('product-grid');
			if (productGrid) {
				function addToCart(item) {
					const cart = getCart();
					const idx = cart.findIndex(i => i.id === item.id);
					if (idx > -1) cart[idx].qty = (cart[idx].qty || 1) + 1;
					else cart.push({ ...item, qty: 1 });
					saveCart(cart);
					updateCartCount();
				}
				document.addEventListener('click', (e) => {
					if (e.target.matches('.add-btn')) {
						const card = e.target.closest('.product');
						if (!card) return;
						const id = card.dataset.id;
						const name = card.dataset.name;
						const price = parseFloat(card.dataset.price || '0');
						const imgEl = card.querySelector('img');
						const img = imgEl ? imgEl.getAttribute('src') : '';
						addToCart({ id, name, price, image: img });
						// UI feedback
						const btn = e.target;
						const prev = btn.textContent;
						btn.textContent = 'Added';
						setTimeout(() => btn.textContent = prev, 700);
					}
				});
			}

			/* React to storage changes */
			window.addEventListener('storage', (ev) => {
				if (ev.key === 'md_cart' || ev.key === 'md_cart_sync') {
					updateCartCount();
				}
			});

			/* Init badge on load */
			if (document.readyState === 'loading') {
				document.addEventListener('DOMContentLoaded', updateCartCount);
			} else {
				updateCartCount();
			}
		})();
	</script>
</body>
</html>
